# 📆 2022-03-21(MON)

## ☑️ 오늘 한 일 📑
- [ ] 읽은 책 서평 작성 (작성완료시 리스트에서 삭제)
    - [ ] 리팩토링 2판
- [x] JPA 7장
- [x] 이펙티브 자바 7장
- [] 알고리즘 레벨2 1문제 이상

<br>

***

### 🔍️ 오늘 무엇을 했나요? Review
#### JPA 고급  매핑
##### 조인 컬럼 
- 테이블 간에 관계는 주로 조인 컬럼이라 부르는 외래 키 컬럼을 사용해서 관리한다. 
- 외래 키에 `null`을 허용하는 관계를 선택적 비식별 관계라 한다. 
  - 외래 키에 `null`을 허용하므로 조인할 때 외부 조인(OUTER JOIN)을 사용해야 한다.
- `@JoinColumn` 으로 매핑

##### 조인 테이블
- 조인 테이블이라는 별도의 테이블을 사용해서 연관관계를 관리한다. 
- 조인 테이블을 사용하는 방법은 연관관계를 관리하는 조인 테이블을 추가하고 여기서 두 테이블의 외래 키를 가지고 연관관계를 관리한다. 
- `@JoinTable`로 매핑 
- 주로 다대다 관계를 일대다, 다대일 관계로 풀어내기 위해 사용
- 연결 테이블, 링크 테이블로도 부른다. 

- 기본은 조인 컬럼을 사용하고 필요하다고 판단되면 조인 테이블을 사용하자

##### 일대일 조인 테이블
- 조인 테이블의 외래 키 컬럼 각각에 총 2개의 유니크 제약조건을 걸어야 한다. 
- `@JoinTable` 속성
  - name : 매핑할 조인 테이블 이름
  - joinColumns : 현재 엔티티를 참조하는 외래 키 
  - inverseJoinColumns : 반대방향 엔티티를 참조하는 외래 키 
- 양방향으로 매핑하려면 `@OneToOne(mappedBy="")`를 추가하면 된다. 

##### 일대다 조인 테이블
- 일대다 관계를 만들려면 조인 테이블의 컬럼 중 다와 관련된 컬럼에 유니트 제약조건을 걸어야 한다.

##### 대대다 조인 테이블
- 다대다 관계를 만들려면 조인 테이블의 두 컬럼을 합해서 하나의 복합 유니크 제약조건을 걸어야 한다. 

##### `@SecondaryTable` 
- 한 엔티티에 여러 테이블을 매핑 
- `@SecondaryTable.name` : 매핑할 다른 테이블의 이름
- `@SecondaryTable.pkJoinColumns` : 매핑할 다른 테이블의 기본 키 컬럼 속성
- `@Column(table = "")`을 사용해서 테이블의 컬럼에 매핑할 수 있다. 테이블을 지정하지 않으면 기본 테이블에 매핑된다. 
- 더 많은 테이블을 매핑하려면 `@SecondaryTables`를 사용하면 된다. 
- `@SecondaryTable`를 사용해서 두 테이블을 하나의 엔티티에 매핑하는 방법보다는 테이블당 엔티티를 각각 만들어서 일대일 매핑하는 것을 권장
  - 일대일 매핑은 원하는 부분만 조회할 수 있고 필요하면 둘을 함께 조회하면 되지만 `@SecondaryTable`는 항상 두 테이블을 조회하므로 최적화가 어렵다. 

#### 이펙티브 자바 
##### 스트림은 주의해서 사용하라 
- 람다에서는 타입 이름을 자주 생략하므로 매개변수 이름을 잘 지어야 스트림 파이프라인의 가독성이 유지된다.
- 도우미 메서드를 적절히 활용하는 일의 중요성은 일반 반복 코드에서보다는 스트림 파이프라인에서 훨씬 크다. 
- `char` 값들을 처리할 때는 스트림을 삼가는 편이 낫다. 
- 스트림이 안성맞춤
  - 원소들의 시퀀스를 일관되게 변환
  - 원소들의 시퀀스를 필터링
  - 하나의 연산을 사용해 결합 ( 더하기, 연결하기, 최솟값 구하기 등)
  - 컬렉션에 모은다 (공통된 속성을 기준으로 묶기
  - 특정 조건을 만족하는 원소를 찾음
- 스트림과 반복 중 어느 쪽이 나은지 확신하기 어렵다면 둘 다 해보고 더 나은 쪽을 택해라 

##### 스트림에서는 부작용 없는 함수를 사용하라 

- 스트림 패러다임의 핵심은 께산을 일련의 변환으로 재구성하는 부분이다. 
  - 순수 함수란 오직 입력만이 결과에 영향을 주는 함수 
  - 다른 가변 상태를 참조하지 않고, 함수 스스로도 다른 상태를 변경하지 않음
  - 스트림 연산에 건네는 함수 객체는 모든 부작용(**side effect**)이 없어야 한다. 
- `forEach` 연산은 스트림 계산 결과를 보고할 때만 사용하고, 계산하는 데는 쓰지 말자. 

##### 반환 타입으로는 스트림보다 컬렉션이 낫다. 
##### 스트림 병렬화는 주의해서 적용하라 
- 동시성 프로그래밍을 할 때는 안전성과 응답 다능 상태를 유지하기 위해 애써야한다. 
  - 병렬 스트림 파이프라인 프로그래밍에서도 다를 바 없다
- 스트림의 소스가 `ArrayList, HashMap, HashSet, ConcurrentHashMap`의 인스턴스거나 배열, int 범우, long 범위일 때 병렬화의 효과가 가장 좋다. 
- 스트림을 잘못 병렬화하면 (응답 불가를 포함해) 성능이 나빠질 뿐만 아니라 결과 자체가 잘못되거나 예상 못한 동작이 발생할 수 있다. 
- 조건이 잘 갖춰지면 `parallel` 메서드 호출 하나로 거의 프로세서 코어 수에 비례하는 성능 향상을 만끽할 수 있다.

#### 프로그래머스 
***

## 💡 오늘 회고

격리 끝에 오랜만에 회사에 복귀했다. 격리 전에 일정에 맞춰서 작업을 다 해놓고 가서 크게 딜레이가 된건 없었지만 수정 사항들이 많았다. 
차근차근 TODO 목록을 정해놓고 하나씩 처리해서 업무시간 안에 다 마무리했다. 내일은 일정관리표를 정리해서 우선순위 분배를 다시 해야겠다. 
빨리 처리할 수 있는 것들은 처리하고 확인해야할 부분들은 일정을 미뤄야지. 

업무시간에 포모도로를 해봤는데 뭔가 잘 맞는거 같지는 않다. 업무 단위로 작업 완료 - 휴식 패턴을 선호하고 유지해왔어서 25-5 간격으로 하는게 오히려 업무가 중간에
끊기거나 포모도로 휴식시간을 잘 안지키는거같다. 처음 해봐서 그런가. 개인 공부할 때는 시간을 딱 잡아주니깐 집중-휴식 간격 유지가 좋았는데 좀 아쉽다. 

JPA 배운 것을 이젠 실전에 적용을 해야겠다. 예제를 직접 작성하면서 하고 있지만 프로젝트에 적용도 시켜야 흡수가 되겠지. 
이펙티브 자바도 어느새 반이상 읽었다. 이 책도 필요에 따라 자주 들여다봐야지. 아직 자바나 스프링에 완벽하지 않은데 kotlin이나 다른 언어들도 배우고 싶다. 
욕심이겠지..

🎯 이번주 목표: **조금씩 꾸준히**

***

## 🎯 내일 할 일 🎯
- [ ] 읽은 책 서평 작성 (작성완료시 리스트에서 삭제)
    - [ ] 리팩토링 2판
- [ ] JPA 8장
- [ ] 알고리즘 레벨2 1문제 이상
- [ ] 줌 클론코딩

***

## 🏁 이번주 목표 🏁
- [ ] 알고리즘 매일 1문제 이상
- [ ] 이펙티브 자바 9장까지 읽기
- [ ] 프로그래머의 뇌 스터디
- [ ] JPA 프로그래밍 9장까지 읽기
- [ ] 읽은 책들 서평 작성
- [ ] 노션 시작
- [ ] 줌 클론코딩 끝내기
- [ ] 개인 프로젝트 작업하기 